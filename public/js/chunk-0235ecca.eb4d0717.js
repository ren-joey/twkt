(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0235ecca"],{1681:function(e,t,a){},cf2a:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.UserInfo&&"Y"===e.UserInfo.is_login?a("v-app",[a("Navigation"),a("Header"),a("Order"),a("DialogContact")],1):e._e()},r=[],s=a("5530"),l=a("2f62"),n=a("ad1b"),o=a("608b"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-main",[a("v-container",[a("v-breadcrumbs",{attrs:{items:e.history},scopedSlots:e._u([{key:"divider",fn:function(){return[a("v-icon",[e._v("mdi-chevron-right")])]},proxy:!0}])}),e.$route.params.method?e._e():a("OrderTable",{attrs:{subtitle:"已完成的需求單",orders:e.CompleteOrders}}),e.$route.params.method?"create"===e.$route.params.method?a("CreateOrder",{attrs:{publishedMaterials:e.publishedMaterials}}):e._e():a("OrderTable",{attrs:{subtitle:"未完成的需求單",orders:e.IncompleteOrders}}),e.$route.params.method?e._e():a("v-btn",{attrs:{bottom:"",color:"pink",dark:"",fab:"",fixed:"",right:""},on:{click:function(t){return e.$router.push({name:"order",params:{method:"create"}})}}},[a("v-icon",[e._v("mdi-plus")])],1)],1)],1)},d=[],u=a("bc3a"),m=a.n(u),h=a("f5ef"),v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",{staticClass:"mx-auto my-4",attrs:{width:"100%"}},[a("v-card-text",[a("p",{staticClass:"headline text--primary"},[e._v(" "+e._s(e.subtitle)+" ")]),a("v-divider"),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.orders,itemKey:"id"}})],1)],1)},f=[],p=(a("c975"),a("a434"),{props:{id:{type:String,default:""},subtitle:{type:String,default:"未命名"},orders:{type:Array,default:function(){return[]}}},data:function(){return{bus:h["a"],dialog:!1,singleSelect:!1,selected:[],singleExpand:!1}},computed:Object(s["a"])(Object(s["a"])({formTitle:function(){return-1===this.editedIndex?"New Item":"Edit Item"},headers:function(){return"user"===this.PermissionName||"guest"===this.PermissionName?[{text:"編號",align:"start",value:"serial_number"},{text:"原料名稱",value:"name"},{text:"來源",value:"origin_name"},{text:"規格1",value:"spec_1"},{text:"規格2",value:"spec_2"},{text:"產地",value:"origin"},{text:"功能",value:"function"},{text:"",value:"data-table-expand"}]:[{text:"編號",align:"start",value:"serial_number"},{text:"原料名稱",value:"name"},{text:"來源",value:"origin_name"},{text:"規格1",value:"spec_1"},{text:"規格2",value:"spec_2"},{text:"產地",value:"origin"},{text:"功能",value:"function"},{text:"操作",value:"actions",sortable:!1},{text:"",value:"data-table-expand"}]}},Object(l["c"])({PermissionName:"getPermissionName",Materials:"getCompleteMaterials"})),Object(l["d"])(["Fetching","UserInfo"])),watch:{dialog:function(e){e||this.close()}},methods:{editItem:function(e){this.editedIndex=this.materials.indexOf(e),this.editedItem=Object(s["a"])({},e),this.dialog=!0},deleteItem:function(e){var t=window,a=t.confirm,i=this.materials.indexOf(e);a("Are you sure you want to delete this item?")&&this.materials.splice(i,1)},close:function(){var e=this;this.dialog=!1,setTimeout((function(){e.editedItem=Object(s["a"])({},e.defaultItem),e.editedIndex=-1}),300)},save:function(){var e=this;this.fetching.editMaterial="Y",setTimeout((function(){e.fetching.editMaterial="N",e.editedIndex>-1?Object.assign(e.materials[e.editedIndex],e.editedItem):e.materials.push(e.editedItem),e.close()}),2e3)},rowClickHandler:function(e){this.$router.push({name:"material",params:{material_id:e.id}})}}}),b=p,x=a("2877"),g=a("6544"),_=a.n(g),M=a("b0af"),y=a("99d9"),O=a("8fea"),C=a("ce7e"),w=Object(x["a"])(b,v,f,!1,null,null,null),I=w.exports;_()(w,{VCard:M["a"],VCardText:y["c"],VDataTable:O["a"],VDivider:C["a"]});var k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-card",{staticClass:"mx-auto my-4",attrs:{maxWidth:"800"}},[a("v-card-title",{staticClass:"headline d-flex justify-space-between align-center"},[a("div",{staticClass:"d-flex align-center"},[e._v(" 訂單資料 ")])]),a("v-card-text",[a("v-divider"),a("v-form",[a("v-container",[a("v-row",{staticClass:"align-center"},[a("v-col",{attrs:{cols:"12",md:"6"}},[a("v-text-field",e._b({attrs:{label:"產品名稱",prependIcon:"mdi-identifier",hideDetails:"",dense:""},model:{value:e.order.name,callback:function(t){e.$set(e.order,"name",t)},expression:"order.name"}},"v-text-field",e.inputAttributes,!1))],1)],1),a("v-row",[a("v-col",{attrs:{cols:"12",sm:"12"}},[a("v-textarea",{attrs:{label:"訂單描述",placeholder:"請詳細敘述產品所要達到的功能",hideDetails:"",autoGrow:"",rounded:"",dense:"",filled:""},model:{value:e.order.description,callback:function(t){e.$set(e.order,"description",t)},expression:"order.description"}})],1),e.selectedMaterials.length>0?a("v-col",[a("v-simple-table",{scopedSlots:e._u([{key:"default",fn:function(){return[a("thead",[a("tr",[a("th",{staticClass:"text-left"},[e._v("原物料名稱")]),a("th",{staticClass:"text-left"},[e._v("功能")]),a("th",{staticClass:"text-left"},[e._v("數量")]),a("th",{staticClass:"text-left"})])]),a("tbody",e._l(e.selectedMaterials,(function(t,i){return a("tr",{key:"selected_"+i+"_"+t.material.serial_number,on:{click:function(t){return e.deleteMaterial(i)}}},[a("td",[e._v(e._s(t.material.name))]),a("td",[e._v(e._s(t.material.function))]),a("td",[e._v(e._s(t.amount))]),a("td",[a("v-btn",{attrs:{icon:"",color:"secondary"}},[a("v-icon",[e._v("mdi-close")])],1)],1)])})),0)]},proxy:!0}],null,!1,798795391)})],1):e._e(),a("v-col",{attrs:{cols:"12"}},[a("v-btn",{attrs:{text:"",xLarge:"",block:"",outlined:"",color:"primary",prependIcon:"mdi-plus"},on:{click:function(t){e.selectMaterialDialog=!0}}},[a("v-icon",[e._v("mdi-plus")]),e._v(" 新增一項產品原物料 ")],1)],1)],1),a("div",{staticClass:"d-flex justify-center"},[a("v-btn",{staticClass:"ma-2",attrs:{color:"primary",xLarge:"",loading:"Y"===e.submitFetching},on:{click:e.save}},[a("v-icon",{attrs:{left:""}},[e._v("mdi-content-save")]),e._v(" 儲存 ")],1)],1)],1)],1)],1)],1),a("v-dialog",{attrs:{maxWidth:"800"},model:{value:e.selectMaterialDialog,callback:function(t){e.selectMaterialDialog=t},expression:"selectMaterialDialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("選擇原物料")]),a("v-card-text",[a("v-simple-table",{scopedSlots:e._u([{key:"default",fn:function(){return[a("thead",[a("tr",[a("th",{staticClass:"text-left"},[e._v("原物料名稱")]),a("th",{staticClass:"text-left"},[e._v("功能")])])]),a("tbody",e._l(e.publishedMaterials,(function(t){return a("tr",{key:t.serial_number,on:{click:function(a){return e.selectMaterial(t)}}},[a("td",[e._v(e._s(t.name))]),a("td",[e._v(e._s(t.function))])])})),0)]},proxy:!0}])}),e.selectedMaterial.material?[a("v-divider",{staticClass:"my-4"}),a("v-row",{attrs:{align:"center",justify:"center"}},[a("v-col",{attrs:{cols:"auto"}},[a("v-text-field",{staticStyle:{flex:"1"},attrs:{disabled:"",rounded:"",hideDetails:"",filled:"",dense:"",label:"原物料名稱"},model:{value:e.selectedMaterial.material.name,callback:function(t){e.$set(e.selectedMaterial.material,"name",t)},expression:"selectedMaterial.material.name"}})],1),a("v-col",{attrs:{cols:"2"}},[a("v-text-field",{staticStyle:{width:"100px"},attrs:{rounded:"",hideDetails:"",filled:"",dense:"",label:"數量"},model:{value:e.selectedMaterial.amount,callback:function(t){e.$set(e.selectedMaterial,"amount",t)},expression:"selectedMaterial.amount"}})],1),a("v-col",{attrs:{cols:"2"}},[a("v-btn",{attrs:{icon:"",color:"grey"},on:{click:function(t){e.selectedMaterial.material=void 0}}},[a("v-icon",[e._v("mdi-close")])],1)],1)],1)]:e._e(),a("v-row",{staticClass:"mt-4",attrs:{justify:"center"}},[a("v-btn",{attrs:{color:"grey",text:"",large:""},on:{click:e.selectMaterialCancel}},[e._v(" 取消 ")]),e.selectedMaterial.material?a("v-btn",{attrs:{color:"success",large:""},on:{click:e.selectMaterialConfirm}},[e._v(" 新增 ")]):e._e()],1)],2)],1)],1)],1)},j=[],V=(a("99af"),a("4160"),a("159b"),{props:{publishedMaterials:{type:Array,default:function(){return[]}}},data:function(){return{order:{name:"",description:""},selectedMaterial:{material:void 0,amount:1},selectedMaterials:[],submitFetching:"N",selectMaterialDialog:!1}},computed:{inputAttributes:function(){return[{disabled:"N"===this.editMode},{filled:!0},{rounded:!0},{dense:!0}]}},methods:{selectMaterial:function(e){this.selectedMaterial.material=e,this.selectedMaterial.amount=1},selectMaterialCancel:function(){this.selectedMaterial.material=void 0,this.selectedMaterial.amount=1,this.selectMaterialDialog=!1},selectMaterialConfirm:function(){this.selectedMaterials.push(Object(s["a"])({},this.selectedMaterial)),this.selectMaterialDialog=!1,this.selectedMaterial.material=void 0,this.selectedMaterial.amount=1},deleteMaterial:function(e){this.selectedMaterials.splice(e,1)},save:function(){var e=this;if(0!==this.selectedMaterials.lendth){var t="";this.selectedMaterials.forEach((function(e,a){0!==a&&(t+=","),t+="".concat(e.material.id,":").concat(e.amount)})),m()({method:"POST",url:"/api/order",params:Object(s["a"])(Object(s["a"])({},this.order),{},{order_details:t})}).then((function(){e.$router.push({name:"order"})}))}else alert("至少需選擇一項原物料")},saveAndSend:function(){}}}),$=V,D=a("8336"),T=a("62ad"),N=a("a523"),H=a("169a"),S=a("4bd4"),F=a("132d"),G=a("0fd9"),E=a("1f4f"),A=a("8654"),z=(a("a9e3"),a("1681"),a("58df")),P=Object(z["a"])(A["a"]),B=P.extend({name:"v-textarea",props:{autoGrow:Boolean,noResize:Boolean,rowHeight:{type:[Number,String],default:24,validator:function(e){return!isNaN(parseFloat(e))}},rows:{type:[Number,String],default:5,validator:function(e){return!isNaN(parseInt(e,10))}}},computed:{classes:function(){return Object(s["a"])({"v-textarea":!0,"v-textarea--auto-grow":this.autoGrow,"v-textarea--no-resize":this.noResizeHandle},A["a"].options.computed.classes.call(this))},noResizeHandle:function(){return this.noResize||this.autoGrow}},watch:{lazyValue:function(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)},rowHeight:function(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)}},mounted:function(){var e=this;setTimeout((function(){e.autoGrow&&e.calculateInputHeight()}),0)},methods:{calculateInputHeight:function(){var e=this.$refs.input;if(e){e.style.height="0";var t=e.scrollHeight,a=parseInt(this.rows,10)*parseFloat(this.rowHeight);e.style.height=Math.max(a,t)+"px"}},genInput:function(){var e=A["a"].options.methods.genInput.call(this);return e.tag="textarea",delete e.data.attrs.type,e.data.attrs.rows=this.rows,e},onInput:function(e){A["a"].options.methods.onInput.call(this,e),this.autoGrow&&this.calculateInputHeight()},onKeyDown:function(e){this.isFocused&&13===e.keyCode&&e.stopPropagation(),this.$emit("keydown",e)}}}),R=Object(x["a"])($,k,j,!1,null,"5e3140d1",null),U=R.exports;_()(R,{VBtn:D["a"],VCard:M["a"],VCardText:y["c"],VCardTitle:y["d"],VCol:T["a"],VContainer:N["a"],VDialog:H["a"],VDivider:C["a"],VForm:S["a"],VIcon:F["a"],VRow:G["a"],VSimpleTable:E["a"],VTextField:A["a"],VTextarea:B});var Y={components:{OrderTable:I,CreateOrder:U},data:function(){return{bus:h["a"],publishedMaterials:[]}},computed:Object(s["a"])(Object(s["a"])({history:function(){var e=[{text:"需求單"}];return"create"===this.$route.params.method&&(e[0].href="/#/order",e.push({text:"新增需求單"})),e}},Object(l["d"])(["Orders"])),Object(l["c"])({CompleteOrders:"getCompleteOrders",IncompleteOrders:"getIncompleteOrders"})),mounted:function(){var e=this;0===this.Orders.length&&this.$store.dispatch("actionFetchOrders"),m()({method:"GET",url:"/api/published-materials"}).then((function(t){e.publishedMaterials=t.data}))}},J=Y,K=a("2bc5"),L=a("f6c4"),W=Object(x["a"])(J,c,d,!1,null,null,null),q=W.exports;_()(W,{VBreadcrumbs:K["a"],VBtn:D["a"],VContainer:N["a"],VIcon:F["a"],VMain:L["a"]});var Q=a("dc50"),X={components:{Navigation:o["a"],Header:n["a"],Order:q,DialogContact:Q["a"]},computed:Object(s["a"])({},Object(l["d"])(["UserInfo"]))},Z=X,ee=a("7496"),te=Object(x["a"])(Z,i,r,!1,null,null,null);t["default"]=te.exports;_()(te,{VApp:ee["a"]})}}]);
//# sourceMappingURL=chunk-0235ecca.eb4d0717.js.map